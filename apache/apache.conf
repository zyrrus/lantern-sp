<VirtualHost *:80>
  ServerName apache.dev.local
  ServerAdmin admin@dev.local

  <Location />
    AuthType GSSAPI
    AuthName "GSSAPI Kerberos Login"
    GssapiAllowedMech krb5
    GssapiAllowedMech ntlmssp
    GssapiCredStore keytab:/shared/http.keytab
    GssapiCredStore client_keytab:/shared/http.keytab
    GssapiCredStore ccache:FILE:/var/run/httpd/krb5ccache
    GssapiUseS4U2Proxy on
    GssapiDelegCcacheDir /var/run/httpd/clientcaches
    GssapiLocalName On
    GssapiUseSessions On
    Require valid-user
  </Location>

  ProxyPreserveHost On
  ProxyPass / http://nextjs-app.dev.local:3000/
  ProxyPassReverse / http://nextjs-app.dev.local:3000/

  RequestHeader set X-Remote-User %{REMOTE_USER}s

  LogLevel auth_gssapi:debug
</VirtualHost>
